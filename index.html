<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>SWING & DEER QR 생성기 (킥보드)</title>
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#000000">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body { font-family: sans-serif; margin: 0; padding: 0; display: flex; flex-direction: column; align-items: center; }
    .controls { margin-top: 2rem; display: flex; flex-direction: column; gap: 1rem; }
    input, button { font-size: 1.2rem; padding: 10px; width: 300px; }
    .qr-container { margin-top: 2rem; width: 5cm; height: 5cm; display: flex; flex-direction: column; align-items: center; justify-content: center; border: 1px solid #ccc; padding: 1rem; }
    .qr-text { margin-top: 0.5cm; font-size: 7pt; font-weight: bold; }
    canvas { width: 4.8cm !important; height: 4.8cm !important; }
  </style>
</head>
<body>
  <h2>SWING & DEER QR 생성기 (킥보드)</h2>
  <div class="controls">
    <input id="qrLabel" type="text" placeholder="QR 아래 표시할 이름">
    <button onclick="generateQR()">QR 생성</button>
    <button onclick="downloadPNG()">PNG 저장</button>
    <button onclick="window.print()">프린트</button>
  </div>
  <div id="preview" class="qr-container">
    <canvas id="qrcode"></canvas>
    <div class="qr-text" id="qrText">QR 이름</div>
  </div>
  <script src="https://cdn.jsdelivr.net/npm/qrcode/build/qrcode.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <script>
    function generateQR() {
      let label = document.getElementById('qrLabel').value.trim().toUpperCase();
      let url = "";
      if (/^\d{5}$/.test(label) || label.startsWith("DEER")) {
        url = `https://deering.co/qr?name=${label}`;
      } else if (label.startsWith("CJ") || label.startsWith("CS")) {
        url = `https://qr.jp.swingmobility.dev/scooter?qr=${label}`;
      } else if (/^[A-Za-z]{2}\d{4}$/.test(label)) {
        url = `https://tswm.link/${label}`;
      } else {
        url = `http://qrcode.theswing.co.kr/swingapp.page.link/${label}`;
      }
      QRCode.toCanvas(document.getElementById('qrcode'), url, { width: 400 }, function (error) {
        if (error) console.error(error);
      });
      document.getElementById('qrText').innerText = label;
    }
    function downloadPNG() {
      html2canvas(document.getElementById('preview')).then(canvas => {
        const link = document.createElement('a');
        link.download = (document.getElementById('qrLabel').value.trim() || 'qr-tag') + ".png";
        link.href = canvas.toDataURL();
        link.click();
      });
    }
  </script>
</body>
</html>